{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"MAAD Attack Framework","text":""},{"location":"#maad-af-is-an-open-source-cloud-attack-tool-for-microsoft-365-entra-idazure-ad-environments","title":"MAAD-AF is an open-source cloud attack tool for Microsoft 365 &amp; Entra ID(Azure AD) environments.","text":"<ul> <li>Designed with the goal to make security testing - Simple, Fast &amp; Effective!</li> <li>Easily &amp; swiftly execute attack modules exploiting EntraID/M365 services.</li> <li>Emulate breach / identity compromise in Microsoft cloud environments.</li> <li>Effectively validate efficacy of security controls and detection &amp; response capabilities against real cyber threats.</li> </ul> <p>MAAD-AF is developed to tackle the common challenges preventing or limiting effective &amp; frequent cloud security testings. Cost, complex processes, infrequency, lack of expertise, infrastructure impact are some of the challenges that currently rig effective security testing. </p>"},{"location":"#why-get-maad-af","title":"Why Get MAAD-AF?","text":""},{"location":"#simple","title":"Simple","text":"<p>MAAD-AF is designed to simplify security testing so everyone and anyone can use it from red team professionals to detection engineers to non-practitioners learning attacks in cloud. With no-command &amp; intuitive prompt based workflow, MAAD-AF delivers a simple framework that makes it easy to understand and execute attack techniques. You can almost ignore this documentation :) </p>"},{"location":"#fast","title":"Fast","text":"<p>Test with 30+ attack modules in under an hour.</p> <p>MAAD-AF's design allows for virtually no-setup process and no special requirements. Combined with no-command &amp; fully interactive workflow users can simply download and start testing their environments with MAAD-AF in no time.</p>"},{"location":"#effective","title":"Effective","text":"<p>MAAD-AF follows and executes techniques captured in MITRE ATT&amp;CK. Run effective security testing by testing against techniques commonly used by attackers in the wild &amp; against frequently targeted cloud services. </p> <p>By making security testing process simple, fast &amp; effective, MAAD-AF aims to enable more organizations &amp; individuals to perform security testing, and promote frequent and effective security testing practices.</p>"},{"location":"#key-features","title":"Key Features","text":"<ul> <li>Extensive Testing Coverage : 30+ attack modules (~50% of MITRE techniques) ranging from initial access, persistence, privilege escalation, defense evasion, credential access, exfiltration, and impact.</li> <li>Effective Testing : Test against techniques frequently used by adversaries &amp; leverage living-off-the-land methods.</li> <li>Ready Out-of-the-Box : No-setup process. Download and start testing.</li> <li>Intutive at its Core : No-commands and a fully interactive prompt-based interface.</li> <li>Clean Testing : Show your cloud some love - revert most actions executed and keep testing impact to minimal.</li> <li>Tool for Everyone : A security tool for everyone who wishes to benefit from effective security testing - from red team professionals to detection engineers validating D&amp;R capabilities to students &amp; future practitioners learning cloud security. </li> </ul>"},{"location":"MAAD%20Attack%20Framework/Architecture/","title":"Design","text":"<p>MAAD-AF is developed natively in PowerShell 5.1 and leverages PowerShell modules to interact with various Microsoft cloud services. All MAAD-AF attack modules are open-source and modular by design making it easy to review, add, deprecate or update them for anyone. </p> MAAD-AF Elements Details <code>MAAD_Attack.ps1</code> Primary controller of all MAAD-AF elements. <code>\\Library</code> Hosts all the attack modules and other MAAD-AF functions. <code>\\Library\\MAAD_Basic_Modules.ps1</code> Primary functions required for MAAD-AF operation such as for logging, dependency checks, local file management, etc. <code>\\Library\\MAAD_Credential_Store_Manager.ps1</code> Manages credentials locally for use during security testing. <code>\\Library\\TOR_Anonymizer.ps1</code> Provides TOR routing feature for keeping MAAD-AF traffic anonymized. <code>\\Library\\AccessModules.ps1</code> Calls microsoft services and establishes connection using testing credentials. The established connections are kept persistent in the powershell session and are maintained even through a MAAD-AF restart."},{"location":"MAAD%20Attack%20Framework/Contributions/","title":"Contributions","text":"<p>Thank you for considering to contribute to MAAD-AF and to the mission of making security testing Simple, Fast &amp; Effective!</p> <p>Your contributions will help make MAAD-AF better :)</p> <p>Submit a Pull Request to the main branch to contribute to MAAD-AF. Pull Requests can include - </p> <ul> <li>new attack techniques </li> <li>bug fixes</li> <li>workflow improvements</li> <li>etc. </li> </ul> <p>If coding is not your jam, consider contributing by - </p> <ul> <li>highlighting issues</li> <li>providing new feature ideas</li> <li>documenting and sharing case studies or use-cases that can help others leverage the tool better</li> </ul> <p>For any bug reports open an issue on the MAAD-AF Github repository.</p> <p>For feedback or any other matter start a discussion on MAAD-AF Github repository or email to maad-af@vectra.ai</p>"},{"location":"MAAD%20Attack%20Framework/Coverage/","title":"Coverage","text":"<p>MAAD-AF provides testing coverage for nearly 50% of all MITRE techniques across O365, Azure AD and SaaS matrices combined.</p>"},{"location":"MAAD%20Attack%20Framework/Coverage/#coverage-map","title":"Coverage MAP","text":""},{"location":"MAAD%20Attack%20Framework/Coverage/#techniques-list","title":"Techniques List","text":"Tactic Technique ID Technique Collection T1114 Email Collection Collection T1213 Data from Information Repositories Collection T1119 Automated Collection Collection T1530 Data from Cloud Storage Credential Access T1528 Steal Application Access Token Credential Access T1110 Brute Force Credential Access T1556 Modify Authentication Process Defense Evasion T1564 Hide Artifacts Defense Evasion T1562 Impair Defenses Defense Evasion T1078 Valid Accounts Defense Evasion T1484 Domain Policy Modification Defense Evasion T1556 Modify Authentication Process Discovery T1069 Permission Groups Discovery Discovery T1087 Account Discovery Impact T1531 Account Access Removal Initial Access T1078 Valid Accounts Persistence T1098 Account Manipulation Persistence T1078 Valid Accounts Persistence T1136 Create Account Persistence T1556 Modify Authentication Process Privilege Escalation T1078 Valid Accounts"},{"location":"MAAD%20Attack%20Framework/Coverage/#open-in-mitre-navigator","title":"Open in MITRE Navigator","text":"<p>Download the MITRE layer file provided below to load &amp; review MAAD-AF associated techniques in MITRE ATT&amp;CK Navigator.</p> <p>Download MAAD-AF Navigator Layer</p> <p>Launch MITRE ATT&amp;CK Navigator</p>"},{"location":"MAAD%20Attack%20Framework/FAQs/","title":"FAQs","text":""},{"location":"MAAD%20Attack%20Framework/FAQs/#does-maad-af-really-stand-for-m365-azure-ad-attack-framework","title":"Does MAAD-AF really stand for M365 &amp; Azure AD Attack Framework?","text":"<p>A: Yes ;) </p>"},{"location":"MAAD%20Attack%20Framework/FAQs/#why-is-maad-af-not-built-using-microsoft-graph","title":"Why is MAAD-AF not built using Microsoft Graph?","text":"<p>A: While Microsoft Graph is the future of interacting with most Microsoft services and is very useful, many needed functionalities are not yet available in certain services of Microsofty cloud. MAAD-AF leverages Graph in certain techniques where it makes sense and will continue migrating existing MAAD-AF modules to Graph as it makes sense. </p>"},{"location":"MAAD%20Attack%20Framework/FAQs/#what-credentials-do-i-need-to-perform-testing-with-maad-af","title":"What credentials do I need to perform testing with MAAD-AF?","text":"<p>A: You can use any Entra ID credential to test with MAAD-AF. It is encouraged to test with different credntials of varying privilges &amp; access. This allows to emulate how different compromised identities would look like in your environment. In general - the higher the privileges, the more techniques you can execute at once, inturn broader testing scope. </p>"},{"location":"MAAD%20Attack%20Framework/FAQs/#how-can-i-add-my-own-custom-techniques-to-maad-af-attack-library","title":"How can I add my own custom techniques to MAAD-AF attack library?","text":"<p>A: Write your attack technique in PowerShell and include the file in <code>/Library</code>. Add an execution option in <code>/Library/MAAD_Attack_Arsenal.ps1</code></p>"},{"location":"MAAD%20Attack%20Framework/FAQs/#is-maad-af-free","title":"Is MAAD-AF free?","text":"<p>A: Yes, MAAD-AF is an open-source tool and will always remain free.</p>"},{"location":"MAAD%20Attack%20Framework/FAQs/#why-test-with-compromised-credentials","title":"Why test with compromised credentials?","text":"<p>A: Testing with \"compromised\" credentials allows organizations to emulate a real breach or scenario of credential compromise. Running MAAD-AF with a \"compromised\" credential allows you to evaluate what's possible for an attacker if organization credentials were compromised and what visibility/response capabilities (&amp; their efficacy) does the organization have to detect and stop these attacks in time. </p>"},{"location":"MAAD%20Attack%20Framework/FAQs/#should-i-worry-about-my-infrastructure-while-testing-with-maad-af","title":"Should I worry about my infrastructure while testing with MAAD-AF?","text":"<p>A: Yes, you should always be cautious when emulating attacks in your environment. The interactive workflow of MAAD-AF allows users to have full control of techniques being executed and resources being targeted. MAAD-AF attempts to provide detailed of information of each module along with MITRE technique association so users can form an informed decision about a modules actions. MAAD-AF also allows to revert actions executed by most modules to minimize the impact to infrastructure. But even with all of these, be very cautious and smart with security testing your environment. </p>"},{"location":"MAAD%20Attack%20Framework/PowerShell%20Modules/","title":"External PS Modules","text":"<p>MAAD-AF leverages several external PowerShell modules to enable interaction with Microsoft cloud services and execute certain techniques. All external powershell modules used by MAAD-AF are available on PowerShellGallery. </p> <p>Review the external PS module list as MAAD-AF will attempt to install and load these modules on the local host.</p> MAAD-AF External PS Modules Az.Accounts Az.Resources AzureAd MSOnline ExchangeOnlineManagement MicrosoftTeams AzureADPreview AADInternals ExchangePowershell Microsoft.Online.SharePoint.PowerShell PnP.PowerShell Microsoft.Graph.Identity.SignIns Microsoft.Graph.Applications Microsoft.Graph.Users Microsoft.Graph.Groups"},{"location":"MAAD-AF%20Modules/","title":"MAAD-AF Modules","text":"<p>MAAD-AF has <code>11</code> primary modules and <code>50+</code> sub-modules that can execute against various services &amp; resources in EntraID (Azure AD) and M365 environment. MAAD-AF attack library is rapidly growing and new techniques are regularly added from maintainers and community contributions.</p>"},{"location":"MAAD-AF%20Modules/#modules","title":"Modules","text":"Module Option Sub-Module Pre-Attack 1 Recon Organization/Identity Pre-Attack 2 Brute-Force Credentials Access 1 Show Available Credentials Access 2 Add Credentials Access 3 Establish Access - All Access 4 Establish Access - AzureAD Access 5 Establish Access - Az Access 6 Establish Access - Exchange Online Access 7 Establish Access - Teams Access 8 Establish Access - Msol Access 9 Establish Access - Sharepoint Site Access 10 Establish Access - Sharepoint Admin Center Access 11 Establish Access - Compliance (eDiscovery) Access 12 Kill All Access Access 13 Anonymize Access with TOR Recon 1 AAD : Find All Accounts Recon 2 AAD : Find All Groups Recon 3 AAD : Find All Service Principals Recon 4 AAD : Find All Auth Policy Recon 5 AAD : Recon Named Locations Recon 6 AAD : Recon Conditional Access Policy Recon 7 AAD : Recon Registered Devices for Account Recon 8 AAD : Recon All Accessible Tenants Recon 9 AAD : Recon Account Group Roles Recon 10 Teams : Recon All Teams Recon 11 SP : Recon All Sharepoint Sites Recon 12 Exchange : Find All Mailboxes Account 1 List Accounts in Tenant Account 2 Deploy Backdoor Account Account 3 Assign Azure AD Role to Account Account 4 Assign Management Role Account Account 5 Reset Password Account 6 Brute-Force Credentials Account 7 Disable Account MFA Account 8 Delete User Group 1 List Groups in Tenant Group 2 Create Group Group 3 Add user to Group Group 4 Assign Role to Group Application 1 List Applications in Tenant Application 2 Create Application Application 3 Generate new Application Credentials AzureAD 1 Modify Trusted IP Config AzureAD 2 Download All Account List AzureAD 3 Exploit Cross Tenant Sync Exchange 1 List Mailboxes in Tenant Exchange 2 Gain Access to Another Mailbox Exchange 3 Setup Email Forwarding Exchange 4 Setup Email Deletion Rule Exchange 5 Disable Mailbox Auditing Exchange 6 Disable Anti-Phishing Policy Teams 1 List Teams in Tenant Teams 2 Search Creds in Teams Teams 3 Invite External User to Teams Sharepoint 1 List Sharepoint Sites Sharepoint 2 Gain Access to Sharepoint Site Sharepoint 3 Search Files in Sharepoint Sharepoint 4 Exfiltrate Data from Sharepoint Sharepoint 5 Upload File to Sharepoint Site Compliance 1 Launch New eDiscovery Search Compliance 2 Recon Existing eDiscovery Cases Compliance 3 Recon Existing eDiscovery Searches Compliance 4 Find eDiscovery Search Details Compliance 5 Find eDiscovery Case Members Compliance 6 Exfil Data with eDiscovery Compliance 7 Escalate eDiscovery Privileges Compliance 8 Install Unified Export Tool"},{"location":"MAAD-AF%20Modules/Access/Access/","title":"Access","text":"<p>The <code>access</code> modules provide functinality for credential management and access management with various Microsoft cloud services. </p> <ul> <li>Add Credentials</li> <li>[Show Available Credentials] (Show Available Credentials.md)</li> <li>Establish Access - All</li> <li>Establish Access - AzureAD</li> <li>Establish Access - Az</li> <li>Establish Access - Exchange Online</li> <li>Establish Access - Teams</li> <li>Establish Access - Msol</li> <li>Establish Access - Sharepoint Site</li> <li>Establish Access - Sharepoint Admin Center</li> <li>Establish Access - Compliance (eDiscovery)</li> <li>Kill All Access</li> <li>Anonymize Access with TOR</li> </ul>"},{"location":"MAAD-AF%20Modules/Access/Add%20Credentials/","title":"Add Credentials","text":""},{"location":"MAAD-AF%20Modules/Access/Add%20Credentials/#description","title":"Description","text":"<p>The <code>add credentials</code> module allows users to save Entra ID credentials in the MAAD Credential Store for use during testing. Users can store multiple credentials using this module that can accessed and used interchangeably to execute other techniques.</p>"},{"location":"MAAD-AF%20Modules/Access/Add%20Credentials/#trigger","title":"Trigger","text":"<pre><code>Trigger 1:\nMAAD Attack Arsenal -&gt; \"Access\" -&gt; 2\n\nTrigger 2: \nMAAD Attack Arsenal -&gt; \"Add Creds\"\n</code></pre>"},{"location":"MAAD-AF%20Modules/Access/Add%20Credentials/#mitre-attck-information","title":"MITRE ATT&amp;CK Information","text":"Tactic Technique N/A N/A"},{"location":"MAAD-AF%20Modules/Access/Add%20Credentials/#additional-details","title":"Additional Details","text":"<p>N/A</p>"},{"location":"MAAD-AF%20Modules/Access/Anonymize%20Access%20with%20TOR/","title":"Anonymize Access with TOR","text":""},{"location":"MAAD-AF%20Modules/Access/Anonymize%20Access%20with%20TOR/#description","title":"Description","text":"<p><code>anonymize access with TOR</code> module sets up a SOCKS proxy and deploys local configuration on host to route network traffic through TOR nodes to anonymize identity. This module requires installation of the TOR executable and updating config in <code>MAAD_Local_Configuration</code> file</p>"},{"location":"MAAD-AF%20Modules/Access/Anonymize%20Access%20with%20TOR/#trigger","title":"Trigger","text":"<pre><code>MAAD Attack Arsenal -&gt; \"Access\" -&gt; 13\n</code></pre>"},{"location":"MAAD-AF%20Modules/Access/Anonymize%20Access%20with%20TOR/#mitre-attck-information","title":"MITRE ATT&amp;CK Information","text":"Tactic Technique Command and Control Proxy"},{"location":"MAAD-AF%20Modules/Access/Anonymize%20Access%20with%20TOR/#additional-details","title":"Additional Details","text":"<ul> <li>This module requires installation of TOR executable which can be downloaded from torproject.org </li> <li>Users also need to update tor_root_directory in <code>MAAD-AF\\Local\\MAAD_Local_Configuration.json</code> with the local installation path of TOR</li> <li>This module modifies two host key values: HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings &amp; HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings</li> </ul>"},{"location":"MAAD-AF%20Modules/Access/Establish%20Access%20-%20All/","title":"Establish Access - All","text":""},{"location":"MAAD-AF%20Modules/Access/Establish%20Access%20-%20All/#description","title":"Description","text":"<p><code>establish access - all</code> module enumerates through various Microsoft services and attempts to establish access with them using the access &amp; privilege of the credential supplied by user.</p>"},{"location":"MAAD-AF%20Modules/Access/Establish%20Access%20-%20All/#trigger","title":"Trigger","text":"<pre><code>Trigger 1:\nMAAD Attack Arsenal -&gt; \"Access\" -&gt; 3\n\nTrigger 2:\nMAAD Attack Arsenal -&gt; \"establish access\"\n</code></pre>"},{"location":"MAAD-AF%20Modules/Access/Establish%20Access%20-%20All/#mitre-attck-information","title":"MITRE ATT&amp;CK Information","text":"Tactic Technique N/A N/A"},{"location":"MAAD-AF%20Modules/Access/Establish%20Access%20-%20All/#additional-details","title":"Additional Details","text":"<p>Microsoft services being accessed by this module:</p> <ul> <li>Entra ID(Azure AD)</li> <li>Sharepoint Admin Center</li> <li>Exchange Online</li> <li>Teams</li> <li>Compliance portal</li> </ul>"},{"location":"MAAD-AF%20Modules/Access/Establish%20Access%20-%20Az/","title":"Establish Access - Az","text":""},{"location":"MAAD-AF%20Modules/Access/Establish%20Access%20-%20Az/#description","title":"Description","text":"<p><code>establish access - az</code> module attempts to establish access with Entra ID(Azure AD) service using the access &amp; privilege of the credential supplied by user.</p>"},{"location":"MAAD-AF%20Modules/Access/Establish%20Access%20-%20Az/#trigger","title":"Trigger","text":"<pre><code>MAAD Attack Arsenal -&gt; \"Access\" -&gt; 5\n</code></pre>"},{"location":"MAAD-AF%20Modules/Access/Establish%20Access%20-%20Az/#mitre-attck-information","title":"MITRE ATT&amp;CK Information","text":"Tactic Technique Initial Access Valid Accounts"},{"location":"MAAD-AF%20Modules/Access/Establish%20Access%20-%20Az/#additional-details","title":"Additional Details","text":"<p>Microsoft services being accessed by this module:</p> <ul> <li>Entra ID (Azure AD)</li> </ul> <p>External PowerShell module used: </p> <ul> <li>Az</li> </ul>"},{"location":"MAAD-AF%20Modules/Access/Establish%20Access%20-%20AzureAD/","title":"Establish Access - AzureAD","text":""},{"location":"MAAD-AF%20Modules/Access/Establish%20Access%20-%20AzureAD/#description","title":"Description","text":"<p><code>establish access - azuread</code> module attempts to establish access with Entra ID(Azure AD) service using the access &amp; privilege of the credential supplied by user.</p>"},{"location":"MAAD-AF%20Modules/Access/Establish%20Access%20-%20AzureAD/#trigger","title":"Trigger","text":"<pre><code>MAAD Attack Arsenal -&gt; \"Access\" -&gt; 4\n</code></pre>"},{"location":"MAAD-AF%20Modules/Access/Establish%20Access%20-%20AzureAD/#mitre-attck-information","title":"MITRE ATT&amp;CK Information","text":"Tactic Technique Initial Access Valid Accounts"},{"location":"MAAD-AF%20Modules/Access/Establish%20Access%20-%20AzureAD/#additional-details","title":"Additional Details","text":"<p>Microsoft services being accessed by this module:</p> <ul> <li>Entra ID (Azure AD)</li> </ul> <p>External PowerShell module used: </p> <ul> <li>AzureAd</li> </ul>"},{"location":"MAAD-AF%20Modules/Access/Establish%20Access%20-%20Compliance%20eDiscovery/","title":"Establish Access - Compliance (eDiscovery)","text":""},{"location":"MAAD-AF%20Modules/Access/Establish%20Access%20-%20Compliance%20eDiscovery/#description","title":"Description","text":"<p><code>establish access - compliance (eDiscovery</code> module attempts to establish access with compliance portal using the access &amp; privilege of the credential supplied by user.</p>"},{"location":"MAAD-AF%20Modules/Access/Establish%20Access%20-%20Compliance%20eDiscovery/#trigger","title":"Trigger","text":"<pre><code>MAAD Attack Arsenal -&gt; \"Access\" -&gt; 11\n</code></pre>"},{"location":"MAAD-AF%20Modules/Access/Establish%20Access%20-%20Compliance%20eDiscovery/#mitre-attck-information","title":"MITRE ATT&amp;CK Information","text":"Tactic Technique Initial Access Valid Accounts"},{"location":"MAAD-AF%20Modules/Access/Establish%20Access%20-%20Compliance%20eDiscovery/#additional-details","title":"Additional Details","text":"<p>Microsoft services being accessed by this module:</p> <ul> <li>Compliance Portal</li> </ul>"},{"location":"MAAD-AF%20Modules/Access/Establish%20Access%20-%20Exchange%20Online/","title":"Establish Access - Exchange Online","text":""},{"location":"MAAD-AF%20Modules/Access/Establish%20Access%20-%20Exchange%20Online/#description","title":"Description","text":"<p><code>establish access - exchange online</code> module attempts to establish access with exchange online service using the access &amp; privilege of the credential supplied by user.</p>"},{"location":"MAAD-AF%20Modules/Access/Establish%20Access%20-%20Exchange%20Online/#trigger","title":"Trigger","text":"<pre><code>MAAD Attack Arsenal -&gt; \"Access\" -&gt; 6\n</code></pre>"},{"location":"MAAD-AF%20Modules/Access/Establish%20Access%20-%20Exchange%20Online/#mitre-attck-information","title":"MITRE ATT&amp;CK Information","text":"Tactic Technique Initial Access Valid Accounts"},{"location":"MAAD-AF%20Modules/Access/Establish%20Access%20-%20Exchange%20Online/#additional-details","title":"Additional Details","text":"<p>External PowerShell module used: </p> <ul> <li>Exchange Online</li> </ul>"},{"location":"MAAD-AF%20Modules/Access/Establish%20Access%20-%20Msol/","title":"Establish Access - Msol","text":""},{"location":"MAAD-AF%20Modules/Access/Establish%20Access%20-%20Msol/#description","title":"Description","text":"<p><code>establish access - msol</code> module attempts to establish access with Entra ID(Azure AD) service using the access &amp; privilege of the credential supplied by user.</p>"},{"location":"MAAD-AF%20Modules/Access/Establish%20Access%20-%20Msol/#trigger","title":"Trigger","text":"<pre><code>MAAD Attack Arsenal -&gt; \"Access\" -&gt; 8\n</code></pre>"},{"location":"MAAD-AF%20Modules/Access/Establish%20Access%20-%20Msol/#mitre-attck-information","title":"MITRE ATT&amp;CK Information","text":"Tactic Technique Initial Access Valid Accounts"},{"location":"MAAD-AF%20Modules/Access/Establish%20Access%20-%20Msol/#additional-details","title":"Additional Details","text":"<p>Microsoft services being accessed by this module:</p> <ul> <li>Entra ID (Azure AD)</li> </ul> <p>External PowerShell module used: </p> <ul> <li>Msol</li> </ul>"},{"location":"MAAD-AF%20Modules/Access/Establish%20Access%20-%20Sharepoint%20Admin%20Center/","title":"Establish Access - Sharepoint Admin Center","text":""},{"location":"MAAD-AF%20Modules/Access/Establish%20Access%20-%20Sharepoint%20Admin%20Center/#description","title":"Description","text":"<p><code>establish access - sharepoint admin center</code> module attempts to establish access with Sharepoint Admin Portal using the access &amp; privilege of the credential supplied by user.</p>"},{"location":"MAAD-AF%20Modules/Access/Establish%20Access%20-%20Sharepoint%20Admin%20Center/#trigger","title":"Trigger","text":"<pre><code>MAAD Attack Arsenal -&gt; \"Access\" -&gt; 10\n</code></pre>"},{"location":"MAAD-AF%20Modules/Access/Establish%20Access%20-%20Sharepoint%20Admin%20Center/#mitre-attck-information","title":"MITRE ATT&amp;CK Information","text":"Tactic Technique Initial Access Valid Accounts"},{"location":"MAAD-AF%20Modules/Access/Establish%20Access%20-%20Sharepoint%20Admin%20Center/#additional-details","title":"Additional Details","text":"<p>Microsoft services being accessed by this module:</p> <ul> <li>Sharepoint Admin Center</li> </ul> <p>External PowerShell module used: </p> <ul> <li>Microsoft.Online.SharePoint.PowerShell</li> </ul>"},{"location":"MAAD-AF%20Modules/Access/Establish%20Access%20-%20Sharepoint%20Site/","title":"Establish Access - Sharepoint Site","text":""},{"location":"MAAD-AF%20Modules/Access/Establish%20Access%20-%20Sharepoint%20Site/#description","title":"Description","text":"<p><code>establish access - sharepoint site</code> module attempts to establish access to a specified sharepoint site using the access of the credential supplied by user.</p>"},{"location":"MAAD-AF%20Modules/Access/Establish%20Access%20-%20Sharepoint%20Site/#trigger","title":"Trigger","text":"<pre><code>MAAD Attack Arsenal -&gt; \"Access\" -&gt; 9\n</code></pre>"},{"location":"MAAD-AF%20Modules/Access/Establish%20Access%20-%20Sharepoint%20Site/#mitre-attck-information","title":"MITRE ATT&amp;CK Information","text":"Tactic Technique Initial Access Valid Accounts"},{"location":"MAAD-AF%20Modules/Access/Establish%20Access%20-%20Sharepoint%20Site/#additional-details","title":"Additional Details","text":"<p>Microsoft services being accessed by this module:</p> <ul> <li>Sharepoint</li> </ul> <p>External PowerShell module used: </p> <ul> <li>Microsoft.Online.SharePoint.PowerShell</li> </ul>"},{"location":"MAAD-AF%20Modules/Access/Establish%20Access%20-%20Teams/","title":"Establish Access - Teams","text":""},{"location":"MAAD-AF%20Modules/Access/Establish%20Access%20-%20Teams/#description","title":"Description","text":"<p><code>establish access - teams</code> module attempts to establish access with Teams service using the access &amp; privilege of the credential supplied by user.</p>"},{"location":"MAAD-AF%20Modules/Access/Establish%20Access%20-%20Teams/#trigger","title":"Trigger","text":"<pre><code>MAAD Attack Arsenal -&gt; \"Access\" -&gt; 7\n</code></pre>"},{"location":"MAAD-AF%20Modules/Access/Establish%20Access%20-%20Teams/#mitre-attck-information","title":"MITRE ATT&amp;CK Information","text":"Tactic Technique Initial Access Valid Accounts"},{"location":"MAAD-AF%20Modules/Access/Establish%20Access%20-%20Teams/#additional-details","title":"Additional Details","text":"<p>Microsoft services being accessed by this module:</p> <ul> <li>Microsoft Teams</li> </ul> <p>External PowerShell module used: </p> <ul> <li>MicrosoftTeams</li> </ul>"},{"location":"MAAD-AF%20Modules/Access/Kill%20All%20Access/","title":"Kill All Access","text":""},{"location":"MAAD-AF%20Modules/Access/Kill%20All%20Access/#description","title":"Description","text":"<p><code>kill all access</code> module terminates all established connections by MAAD-AF to all Microsoft Services .</p>"},{"location":"MAAD-AF%20Modules/Access/Kill%20All%20Access/#trigger","title":"Trigger","text":"<pre><code>MAAD Attack Arsenal -&gt; \"Access\" -&gt; 12\n</code></pre>"},{"location":"MAAD-AF%20Modules/Access/Kill%20All%20Access/#mitre-attck-information","title":"MITRE ATT&amp;CK Information","text":"Tactic Technique N/A N/A"},{"location":"MAAD-AF%20Modules/Access/Kill%20All%20Access/#additional-details","title":"Additional Details","text":"<p>N/A</p>"},{"location":"MAAD-AF%20Modules/Access/Show%20Available%20Credentials/","title":"Show Available Credentials","text":""},{"location":"MAAD-AF%20Modules/Access/Show%20Available%20Credentials/#description","title":"Description","text":"<p><code>show available credentials</code> is an operational module that displays all available credentials stored in MAAD Credential Store.</p>"},{"location":"MAAD-AF%20Modules/Access/Show%20Available%20Credentials/#trigger","title":"Trigger","text":"<pre><code>Trigger 1:\nMAAD Attack Arsenal -&gt; \"Access\" -&gt; 1\n\nTrigegr 2: \nMAAD Attack Arsenal -&gt; \"SHOW CREDS\"\n</code></pre>"},{"location":"MAAD-AF%20Modules/Access/Show%20Available%20Credentials/#mitre-attck-information","title":"MITRE ATT&amp;CK Information","text":"Tactic Technique N/A N/A"},{"location":"MAAD-AF%20Modules/Access/Show%20Available%20Credentials/#additional-details","title":"Additional Details","text":"<p>N/A</p>"},{"location":"MAAD-AF%20Modules/Account/Account/","title":"Account","text":"<p>The <code>account</code> module provides techniques that target or take action against an account/identity in Entra ID. </p> <ul> <li>List Accounts in Tenant</li> <li>Deploy Backdoor Account</li> <li>Assign Azure AD Role to Account</li> <li>Assign Management Role Account</li> <li>Reset Password</li> <li>Brute-Force Credentials</li> <li>Disable Account MFA</li> <li>Delete User</li> </ul>"},{"location":"MAAD-AF%20Modules/Account/Assign%20Azure%20AD%20Role%20to%20Account/","title":"Assign Azure AD Role to Account","text":""},{"location":"MAAD-AF%20Modules/Account/Assign%20Azure%20AD%20Role%20to%20Account/#description","title":"Description","text":"<p><code>assign azure ad role to account</code> module attempts to assign a azure ad role to a specified target account. This can be used to elevate privileges by granting roles to an account under control in the tenant. </p>"},{"location":"MAAD-AF%20Modules/Account/Assign%20Azure%20AD%20Role%20to%20Account/#trigger","title":"Trigger","text":"<pre><code>MAAD Attack Arsenal -&gt; \"Account\" -&gt; 3\n</code></pre>"},{"location":"MAAD-AF%20Modules/Account/Assign%20Azure%20AD%20Role%20to%20Account/#mitre-attck-information","title":"MITRE ATT&amp;CK Information","text":"Tactic Technique Persistence Account Manipulation: Additional Cloud Roles"},{"location":"MAAD-AF%20Modules/Account/Assign%20Azure%20AD%20Role%20to%20Account/#additional-details","title":"Additional Details","text":"<p>Microsoft services being accessed by this module:</p> <ul> <li>Entra ID (Azure AD)</li> </ul> <p>External PowerShell module used: </p> <ul> <li>AzureAd</li> </ul>"},{"location":"MAAD-AF%20Modules/Account/Assign%20Management%20Role%20Account/","title":"Assign Management Role Account","text":""},{"location":"MAAD-AF%20Modules/Account/Assign%20Management%20Role%20Account/#description","title":"Description","text":"<p><code>assign management role account</code> module attempts to assign a management role to a specified target account. This can be used to elevate privileges by granting roles to an account under control in the tenant. </p>"},{"location":"MAAD-AF%20Modules/Account/Assign%20Management%20Role%20Account/#trigger","title":"Trigger","text":"<pre><code>MAAD Attack Arsenal -&gt; \"Account\" -&gt; 4\n</code></pre>"},{"location":"MAAD-AF%20Modules/Account/Assign%20Management%20Role%20Account/#mitre-attck-information","title":"MITRE ATT&amp;CK Information","text":"Tactic Technique Persistence Account Manipulation: Additional Cloud Roles"},{"location":"MAAD-AF%20Modules/Account/Assign%20Management%20Role%20Account/#additional-details","title":"Additional Details","text":"<p>Microsoft services being accessed by this module:</p> <ul> <li>Entra ID (Azure AD)</li> </ul> <p>External PowerShell module used: </p> <ul> <li>ExchangePowerShell</li> </ul>"},{"location":"MAAD-AF%20Modules/Account/Brute-Force%20Credentials/","title":"Brute-Force Credentials","text":""},{"location":"MAAD-AF%20Modules/Account/Brute-Force%20Credentials/#description","title":"Description","text":"<p><code>brute-force credentials</code> module executes a password brute-force attack on a target identity in Entra ID. Brute-force attempts to gain access to an account when the password for the account is unknown. </p> <p>This module requires a password list in txt file format as input for bruteforce. Placed the password file in <code>\\MAAD-AF</code> directory.</p> <p>If the brute-force is successful, this module stores the cracked credentials in MAAD Credential Store for use in future.</p>"},{"location":"MAAD-AF%20Modules/Account/Brute-Force%20Credentials/#trigger","title":"Trigger","text":"<pre><code>MAAD Attack Arsenal -&gt; \"Account\" -&gt; 6\n</code></pre>"},{"location":"MAAD-AF%20Modules/Account/Brute-Force%20Credentials/#mitre-attck-information","title":"MITRE ATT&amp;CK Information","text":"Tactic Technique Credential Access Brute Force"},{"location":"MAAD-AF%20Modules/Account/Brute-Force%20Credentials/#additional-details","title":"Additional Details","text":"<ul> <li>Brute-force is attempted against the reporting web service endpoint: https://reports.office365.com/ecp/reportingwebservice/reporting.svc</li> </ul>"},{"location":"MAAD-AF%20Modules/Account/Delete%20User/","title":"Delete User","text":""},{"location":"MAAD-AF%20Modules/Account/Delete%20User/#description","title":"Description","text":"<p><code>delete user</code> module attempts to remove an identity from Entra ID to disable access. Users cannot use this module to remove the identity thats currently being used by MAAD-AF to access Entra ID.</p>"},{"location":"MAAD-AF%20Modules/Account/Delete%20User/#trigger","title":"Trigger","text":"<pre><code>MAAD Attack Arsenal -&gt; \"Account\" -&gt; 8\n</code></pre>"},{"location":"MAAD-AF%20Modules/Account/Delete%20User/#mitre-attck-information","title":"MITRE ATT&amp;CK Information","text":"Tactic Technique Impact Account Access Removal"},{"location":"MAAD-AF%20Modules/Account/Delete%20User/#additional-details","title":"Additional Details","text":"<p>Microsoft services being accessed by this module:</p> <ul> <li>Entra ID (Azure AD)</li> </ul> <p>External PowerShell module used: </p> <ul> <li>AzureAd</li> </ul>"},{"location":"MAAD-AF%20Modules/Account/Deploy%20Backdoor%20Account/","title":"Deploy Backdoor Account","text":""},{"location":"MAAD-AF%20Modules/Account/Deploy%20Backdoor%20Account/#description","title":"Description","text":"<p><code>deploy backdoor account</code> module creates a new identity in Entra ID that can be used as a backdoor for persistent access to the tenant. No roles are assigned to the new identity. To do that users can use <code>assign azure ad role to account</code> &amp; <code>assign management role to account</code> modules.</p> <p>If a backdoor account is successfully deployes, this modules stores the new identity information to MAAD Credential Store for use in future. </p>"},{"location":"MAAD-AF%20Modules/Account/Deploy%20Backdoor%20Account/#trigger","title":"Trigger","text":"<pre><code>MAAD Attack Arsenal -&gt; \"Account\" -&gt; 2\n</code></pre>"},{"location":"MAAD-AF%20Modules/Account/Deploy%20Backdoor%20Account/#mitre-attck-information","title":"MITRE ATT&amp;CK Information","text":"Tactic Technique Persistence Create Account: Cloud Account"},{"location":"MAAD-AF%20Modules/Account/Deploy%20Backdoor%20Account/#additional-details","title":"Additional Details","text":"<p>Microsoft services being accessed by this module:</p> <ul> <li>Entra ID (Azure AD)</li> </ul> <p>External PowerShell module used: </p> <ul> <li>AzureAd</li> </ul>"},{"location":"MAAD-AF%20Modules/Account/Disable%20Account%20MFA/","title":"Disable Account MFA","text":""},{"location":"MAAD-AF%20Modules/Account/Disable%20Account%20MFA/#description","title":"Description","text":"<p><code>disable account mfa</code> module attempts to disable tenant level MFA on a target account in Entra ID.</p>"},{"location":"MAAD-AF%20Modules/Account/Disable%20Account%20MFA/#trigger","title":"Trigger","text":"<pre><code>MAAD Attack Arsenal -&gt; \"Account\" -&gt; 7\n</code></pre>"},{"location":"MAAD-AF%20Modules/Account/Disable%20Account%20MFA/#mitre-attck-information","title":"MITRE ATT&amp;CK Information","text":"Tactic Technique Persistence Modify Authentication Process: Multi-Factor Authentication Defense Evasion Modify Authentication Process: Multi-Factor Authentication Credential Access Modify Authentication Process: Multi-Factor Authentication"},{"location":"MAAD-AF%20Modules/Account/Disable%20Account%20MFA/#additional-details","title":"Additional Details","text":"<p>Microsoft services being accessed by this module:</p> <ul> <li>Entra ID (Azure AD)</li> </ul> <p>External PowerShell module used: </p> <ul> <li>AzureAd</li> </ul>"},{"location":"MAAD-AF%20Modules/Account/List%20Accounts%20in%20Tenant/","title":"List Accounts in Tenant","text":""},{"location":"MAAD-AF%20Modules/Account/List%20Accounts%20in%20Tenant/#description","title":"Description","text":"<p><code>list accounts in tenant</code> module performs reconnaissance in the connected Entra ID tenant to lists all accounts in it. If the result is too large to display, this module dumps the accounts found into <code>\\Outputs</code> directory.</p>"},{"location":"MAAD-AF%20Modules/Account/List%20Accounts%20in%20Tenant/#trigger","title":"Trigger","text":"<pre><code>MAAD Attack Arsenal -&gt; \"Account\" -&gt; 1\n</code></pre>"},{"location":"MAAD-AF%20Modules/Account/List%20Accounts%20in%20Tenant/#mitre-attck-information","title":"MITRE ATT&amp;CK Information","text":"Tactic Technique Discovery Account Discovery: Cloud Account"},{"location":"MAAD-AF%20Modules/Account/List%20Accounts%20in%20Tenant/#additional-details","title":"Additional Details","text":"<p>Microsoft services being accessed by this module:</p> <ul> <li>Entra ID (Azure AD)</li> </ul> <p>External PowerShell module used: </p> <ul> <li>AzureAd</li> </ul>"},{"location":"MAAD-AF%20Modules/Account/Reset%20Password/","title":"Reset Password","text":""},{"location":"MAAD-AF%20Modules/Account/Reset%20Password/#description","title":"Description","text":"<p><code>reset password</code> module allows users to reset password of another identity in Entra ID. Resetting the password can allow access as the target entity leading to privilege escalation. </p> <p>If a target identity's password is successfully reset, this module will store the new credentials for the identity to MAAD Credential Store for use in future. </p>"},{"location":"MAAD-AF%20Modules/Account/Reset%20Password/#trigger","title":"Trigger","text":"<pre><code>MAAD Attack Arsenal -&gt; \"Account\" -&gt; 5\n</code></pre>"},{"location":"MAAD-AF%20Modules/Account/Reset%20Password/#mitre-attck-information","title":"MITRE ATT&amp;CK Information","text":"Tactic Technique Defense Evasion Valid Accounts: Cloud Accounts Persistence Valid Accounts: Cloud Accounts Privilege Escalation Valid Accounts: Cloud Accounts Initial Access Valid Accounts: Cloud Accounts"},{"location":"MAAD-AF%20Modules/Account/Reset%20Password/#additional-details","title":"Additional Details","text":"<p>Microsoft services being accessed by this module:</p> <ul> <li>Entra ID (Azure AD)</li> </ul> <p>External PowerShell module used: </p> <ul> <li>AzureAd</li> </ul>"},{"location":"MAAD-AF%20Modules/Application/Application/","title":"Application","text":"<p>The <code>application</code> module provides techniques that target or take action against an application in Entra ID. </p> <ul> <li>List Applications in Tenant</li> <li>Create Application</li> <li>Generate new Application Credentials</li> </ul>"},{"location":"MAAD-AF%20Modules/Application/Create%20Application/","title":"Create Application","text":""},{"location":"MAAD-AF%20Modules/Application/Create%20Application/#description","title":"Description","text":"<p><code>create application</code> module creates a new service principal in Entra ID. </p>"},{"location":"MAAD-AF%20Modules/Application/Create%20Application/#trigger","title":"Trigger","text":"<pre><code>MAAD Attack Arsenal -&gt; \"Application\" -&gt; 2\n</code></pre>"},{"location":"MAAD-AF%20Modules/Application/Create%20Application/#mitre-attck-information","title":"MITRE ATT&amp;CK Information","text":"Tactic Technique Persistence Create Account: Cloud Account"},{"location":"MAAD-AF%20Modules/Application/Create%20Application/#additional-details","title":"Additional Details","text":"<p>Microsoft services being accessed by this module:</p> <ul> <li>Entra ID (Azure AD)</li> </ul> <p>External PowerShell module used: </p> <ul> <li>AzureAd</li> </ul>"},{"location":"MAAD-AF%20Modules/Application/Generate%20new%20Application%20Credentials/","title":"Generate new Application Credentials","text":""},{"location":"MAAD-AF%20Modules/Application/Generate%20new%20Application%20Credentials/#description","title":"Description","text":"<p><code>generate new application credentials</code> module attempts to generate new credentials for an application in Entra ID. This can potentially allow performing actions using the access &amp; privilege of the target application. </p> <p>The module stores the generated application credentials in MAAD Credential Store for use in future.</p>"},{"location":"MAAD-AF%20Modules/Application/Generate%20new%20Application%20Credentials/#trigger","title":"Trigger","text":"<pre><code>MAAD Attack Arsenal -&gt; \"Application\" -&gt; 3\n</code></pre>"},{"location":"MAAD-AF%20Modules/Application/Generate%20new%20Application%20Credentials/#mitre-attck-information","title":"MITRE ATT&amp;CK Information","text":"Tactic Technique Defense Evasion Valid Accounts: Cloud Accounts Persistence Valid Accounts: Cloud Accounts Privilege Escalation Valid Accounts: Cloud Accounts Initial Access Valid Accounts: Cloud Accounts"},{"location":"MAAD-AF%20Modules/Application/Generate%20new%20Application%20Credentials/#additional-details","title":"Additional Details","text":"<p>Revert module changes: No</p> <p>Microsoft services being accessed by this module:</p> <ul> <li>Entra ID (Azure AD)</li> </ul> <p>External PowerShell module used: </p> <ul> <li>AzureAd</li> </ul>"},{"location":"MAAD-AF%20Modules/Application/List%20Applications%20in%20Tenant/","title":"List Applications in Tenant","text":""},{"location":"MAAD-AF%20Modules/Application/List%20Applications%20in%20Tenant/#description","title":"Description","text":"<p><code>list applications in tenant</code> module attempts to assign a azure ad role to a specified target account. This can be used to elevate privileges by granting roles to an account under control in the tenant. </p>"},{"location":"MAAD-AF%20Modules/Application/List%20Applications%20in%20Tenant/#trigger","title":"Trigger","text":"<pre><code>MAAD Attack Arsenal -&gt; \"Application\" -&gt; 1\n</code></pre>"},{"location":"MAAD-AF%20Modules/Application/List%20Applications%20in%20Tenant/#mitre-attck-information","title":"MITRE ATT&amp;CK Information","text":"Tactic Technique Persistence Account Manipulation: Additional Cloud Roles"},{"location":"MAAD-AF%20Modules/Application/List%20Applications%20in%20Tenant/#additional-details","title":"Additional Details","text":"<p>Microsoft services being accessed by this module:</p> <ul> <li>Entra ID (Azure AD)</li> </ul> <p>External PowerShell module used: </p> <ul> <li>AzureAd</li> </ul>"},{"location":"MAAD-AF%20Modules/AzureAD/AzureAD/","title":"AzureAD","text":"<p>The <code>azuread</code> module provides techniques that target and take action against resources and configurations in Entra ID (Azure AD). </p> <ul> <li>Modify Trusted IP Config</li> <li>Download All Account List</li> <li>Exploit Cross Tenant Sync</li> </ul>"},{"location":"MAAD-AF%20Modules/AzureAD/Download%20All%20Account%20List/","title":"Download All Acount List","text":""},{"location":"MAAD-AF%20Modules/AzureAD/Download%20All%20Account%20List/#description","title":"Description","text":"<p><code>download all account list</code> module executes reconnaissance and dumps all identities in the connected tenant.</p>"},{"location":"MAAD-AF%20Modules/AzureAD/Download%20All%20Account%20List/#trigger","title":"Trigger","text":"<pre><code>MAAD Attack Arsenal -&gt; \"AzureAD\" -&gt; 2\n</code></pre>"},{"location":"MAAD-AF%20Modules/AzureAD/Download%20All%20Account%20List/#mitre-attck-information","title":"MITRE ATT&amp;CK Information","text":"Tactic Technique Discovery Account Discovery: Cloud Account"},{"location":"MAAD-AF%20Modules/AzureAD/Download%20All%20Account%20List/#additional-details","title":"Additional Details","text":"<p>Revert module changes: N/A</p> <p>Microsoft services accessed by module:</p> <ul> <li>Entra ID (Azure AD)</li> </ul> <p>External PowerShell module used: </p> <ul> <li>AzureAd</li> </ul>"},{"location":"MAAD-AF%20Modules/AzureAD/Exploit%20Cross%20Tenant%20Sync/","title":"Exploit Cross Tenant Sync","text":""},{"location":"MAAD-AF%20Modules/AzureAD/Exploit%20Cross%20Tenant%20Sync/#description","title":"Description","text":"<p><code>exploit cross tenant sync</code> module hosts multiple sub-modules that exploit the Cross Tenant Synchronization feature in Entra ID allowing users to execute lateral movement and establish persistence in the target environment. </p> <p>Sub-modules under <code>exploit cross tenant sync</code> module: </p> <ul> <li>List Currently Accessible Tenants</li> <li>List Azure2Azure Template Applications in Tenant</li> <li>Find Target Tenants in Existing Cross Tenant Access Policy</li> <li>Inspect Deployed Cross Tenant Access Policy Configuration</li> <li>Find CTS Application of a Target Tenant</li> <li>Sync User to Target Tenant</li> <li>Add User to CTS Sync Group</li> <li>Deploy backdoor using Cross Tenant Synchronization</li> </ul>"},{"location":"MAAD-AF%20Modules/AzureAD/Exploit%20Cross%20Tenant%20Sync/#trigger","title":"Trigger","text":"<pre><code>MAAD Attack Arsenal -&gt; \"AzureAD\" -&gt; 1\n</code></pre>"},{"location":"MAAD-AF%20Modules/AzureAD/Exploit%20Cross%20Tenant%20Sync/#mitre-attck-information","title":"MITRE ATT&amp;CK Information","text":"Tactic Technique Persistence Create Account: Cloud Account"},{"location":"MAAD-AF%20Modules/AzureAD/Exploit%20Cross%20Tenant%20Sync/#additional-details","title":"Additional Details","text":"<p>This module is based on the techniques discussed in this research blog: Exploiting Cross Tenant Synchronization</p> <p>Revert module changes: No</p> <p>Microsoft services accessed by module:</p> <ul> <li>Entra ID (Azure AD)</li> </ul> <p>PowerShell module used: </p> <ul> <li>Microsoft.Graph.Identity.SignIns</li> <li>Microsoft.Graph.Applications</li> <li>Microsoft.Graph.Users</li> <li>Microsoft.Graph.Groups</li> </ul>"},{"location":"MAAD-AF%20Modules/AzureAD/Modify%20Trusted%20IP%20Config/","title":"Modify Trusted IP Config","text":""},{"location":"MAAD-AF%20Modules/AzureAD/Modify%20Trusted%20IP%20Config/#description","title":"Description","text":"<p><code>modify trusted ip config</code> module deploys a new named location policy which adds a specified IP as trusted in the Entra ID environment. This can allow users to circumvent certain conditional access policies in the environment enforcing access for only trusted locations. </p> <p>The module accepts a static IP for configuring the named location policy or can automatically query users current public IP for the configuration.</p>"},{"location":"MAAD-AF%20Modules/AzureAD/Modify%20Trusted%20IP%20Config/#trigger","title":"Trigger","text":"<pre><code>MAAD Attack Arsenal -&gt; \"AzureAD\" -&gt; 1\n</code></pre>"},{"location":"MAAD-AF%20Modules/AzureAD/Modify%20Trusted%20IP%20Config/#mitre-attck-information","title":"MITRE ATT&amp;CK Information","text":"Tactic Technique Defense Evasion Impair Defenses"},{"location":"MAAD-AF%20Modules/AzureAD/Modify%20Trusted%20IP%20Config/#additional-details","title":"Additional Details","text":"<p>Revert module changes: Yes</p> <p>Microsoft services accessed by module:</p> <ul> <li>Entra ID (Azure AD)</li> </ul> <p>External PowerShell module used: </p> <ul> <li>AzureAd</li> </ul>"},{"location":"MAAD-AF%20Modules/Compliance/Compliance/","title":"Compliance","text":"<p>The <code>compliance</code> module provides techniques that target or take action against tools &amp; resources in Compliance portal. </p> <ul> <li>Launch New Search with eDiscovery</li> <li>Recon Existing eDiscovery Cases</li> <li>Recon Existing eDiscovery Searches</li> <li>Find eDiscovery Search Details</li> <li>Find eDiscovery Case Members</li> <li>Exfil Data with eDiscovery</li> <li>Escalate eDiscovery Privileges</li> <li>Install Unified Export Tool</li> </ul>"},{"location":"MAAD-AF%20Modules/Compliance/Escalate%20eDiscovery%20Privileges/","title":"Escalate eDiscovery Privileges","text":""},{"location":"MAAD-AF%20Modules/Compliance/Escalate%20eDiscovery%20Privileges/#description","title":"Description","text":"<p><code>escalate ediscovery privileges</code> module escalates the connected identities privileges by attempting to assign the eDiscovery Manager/Administrator roles.</p>"},{"location":"MAAD-AF%20Modules/Compliance/Escalate%20eDiscovery%20Privileges/#trigger","title":"Trigger","text":"<pre><code>MAAD Attack Arsenal -&gt; \"Compliance\" -&gt; 7\n</code></pre>"},{"location":"MAAD-AF%20Modules/Compliance/Escalate%20eDiscovery%20Privileges/#mitre-attck-information","title":"MITRE ATT&amp;CK Information","text":"Tactic Technique Persistence Account Manipulation: Additional Cloud Roles"},{"location":"MAAD-AF%20Modules/Compliance/Escalate%20eDiscovery%20Privileges/#additional-details","title":"Additional Details","text":"<p>Revert module changes: No</p> <p>Microsoft services being accessed by this module:</p> <ul> <li>Compliance</li> </ul> <p>External PowerShell module used: </p> <ul> <li>ExchangePowerShell</li> </ul>"},{"location":"MAAD-AF%20Modules/Compliance/Exfil%20Data%20with%20eDiscovery/","title":"Exfil Data from eDiscovery","text":""},{"location":"MAAD-AF%20Modules/Compliance/Exfil%20Data%20with%20eDiscovery/#description","title":"Description","text":"<p><code>exfil data from ediscovery</code> module exfiltrates data from search results of a newly created or existing search of a eDiscovery case.</p>"},{"location":"MAAD-AF%20Modules/Compliance/Exfil%20Data%20with%20eDiscovery/#trigger","title":"Trigger","text":"<pre><code>MAAD Attack Arsenal -&gt; \"Compliance\" -&gt; 6\n</code></pre>"},{"location":"MAAD-AF%20Modules/Compliance/Exfil%20Data%20with%20eDiscovery/#mitre-attck-information","title":"MITRE ATT&amp;CK Information","text":"Tactic Technique Collection Automated Collection"},{"location":"MAAD-AF%20Modules/Compliance/Exfil%20Data%20with%20eDiscovery/#additional-details","title":"Additional Details","text":"<p>Revert module changes: No</p> <p>Microsoft services being accessed by this module:</p> <ul> <li>Compliance</li> </ul> <p>External PowerShell module used: </p> <ul> <li>ExchangePowerShell</li> </ul>"},{"location":"MAAD-AF%20Modules/Compliance/Find%20eDiscovery%20Case%20Members/","title":"Find eDiscovery Case Members","text":""},{"location":"MAAD-AF%20Modules/Compliance/Find%20eDiscovery%20Case%20Members/#description","title":"Description","text":"<p><code>find ediscovery case members</code> module performs reconnaissance to find out details on members part of an eDiscovery case. Identifying members of a case can help identiy the importance of a particular case. </p>"},{"location":"MAAD-AF%20Modules/Compliance/Find%20eDiscovery%20Case%20Members/#trigger","title":"Trigger","text":"<pre><code>MAAD Attack Arsenal -&gt; \"Compliance\" -&gt; 5\n</code></pre>"},{"location":"MAAD-AF%20Modules/Compliance/Find%20eDiscovery%20Case%20Members/#mitre-attck-information","title":"MITRE ATT&amp;CK Information","text":"Tactic Technique N/A N/A"},{"location":"MAAD-AF%20Modules/Compliance/Find%20eDiscovery%20Case%20Members/#additional-details","title":"Additional Details","text":"<p>Revert module changes: N/A</p> <p>Microsoft services being accessed by this module:</p> <ul> <li>Compliance</li> </ul> <p>External PowerShell module used: </p> <ul> <li>ExchangePowerShell</li> </ul>"},{"location":"MAAD-AF%20Modules/Compliance/Find%20eDiscovery%20Search%20Details/","title":"Find eDiscovery Search Details","text":""},{"location":"MAAD-AF%20Modules/Compliance/Find%20eDiscovery%20Search%20Details/#description","title":"Description","text":"<p><code>find ediscovery search details</code> module performs reconnaissance to find out details such as search creator, creation date, results returned, etc. pertaining to a specific search in an eDiscovery case.</p>"},{"location":"MAAD-AF%20Modules/Compliance/Find%20eDiscovery%20Search%20Details/#trigger","title":"Trigger","text":"<pre><code>MAAD Attack Arsenal -&gt; \"Compliance\" -&gt; 4\n</code></pre>"},{"location":"MAAD-AF%20Modules/Compliance/Find%20eDiscovery%20Search%20Details/#mitre-attck-information","title":"MITRE ATT&amp;CK Information","text":"Tactic Technique N/A N/A"},{"location":"MAAD-AF%20Modules/Compliance/Find%20eDiscovery%20Search%20Details/#additional-details","title":"Additional Details","text":"<p>Revert module changes: N/A</p> <p>Microsoft services being accessed by this module:</p> <ul> <li>Compliance</li> </ul> <p>External PowerShell module used: </p> <ul> <li>ExchangePowerShell</li> </ul>"},{"location":"MAAD-AF%20Modules/Compliance/Install%20Unified%20Export%20Tool/","title":"Install Unified Export Tool","text":""},{"location":"MAAD-AF%20Modules/Compliance/Install%20Unified%20Export%20Tool/#description","title":"Description","text":"<p><code>install unified export tool</code> module gets and installs the unified export tool on the local host which is required to exfiltrate the results of an eDiscovery search. </p>"},{"location":"MAAD-AF%20Modules/Compliance/Install%20Unified%20Export%20Tool/#trigger","title":"Trigger","text":"<pre><code>MAAD Attack Arsenal -&gt; \"Compliance\" -&gt; 8\n</code></pre>"},{"location":"MAAD-AF%20Modules/Compliance/Install%20Unified%20Export%20Tool/#mitre-attck-information","title":"MITRE ATT&amp;CK Information","text":"Tactic Technique N/A N/A"},{"location":"MAAD-AF%20Modules/Compliance/Install%20Unified%20Export%20Tool/#additional-details","title":"Additional Details","text":"<p>Revert module changes: N/A</p> <p>Installs unified export tool on the local host.</p>"},{"location":"MAAD-AF%20Modules/Compliance/Launch%20New%20eDiscovery%20Search/","title":"Launch New eDiscovery Search","text":""},{"location":"MAAD-AF%20Modules/Compliance/Launch%20New%20eDiscovery%20Search/#description","title":"Description","text":"<p><code>launch new ediscovery search</code> module creates a new search in a new or existing eDiscovery case to find data across multiple data repositories.</p>"},{"location":"MAAD-AF%20Modules/Compliance/Launch%20New%20eDiscovery%20Search/#trigger","title":"Trigger","text":"<pre><code>MAAD Attack Arsenal -&gt; \"Compliance\" -&gt; 1\n</code></pre>"},{"location":"MAAD-AF%20Modules/Compliance/Launch%20New%20eDiscovery%20Search/#mitre-attck-information","title":"MITRE ATT&amp;CK Information","text":"Tactic Technique Collection Automated Collection"},{"location":"MAAD-AF%20Modules/Compliance/Launch%20New%20eDiscovery%20Search/#additional-details","title":"Additional Details","text":"<p>Revert module changes: No</p> <p>Microsoft services being accessed by this module:</p> <ul> <li>Compliance</li> </ul> <p>External PowerShell module used: </p> <ul> <li>ExchangePowerShell</li> </ul>"},{"location":"MAAD-AF%20Modules/Compliance/Recon%20Existing%20eDiscovery%20Cases/","title":"Recon Existing eDiscovery Cases","text":""},{"location":"MAAD-AF%20Modules/Compliance/Recon%20Existing%20eDiscovery%20Cases/#description","title":"Description","text":"<p><code>recon existing ediscovery cases</code> module executes reconnaissance to find existing cases in the tenant. Existing cases in environment can help quickly find critical data without having to launch new searches.</p>"},{"location":"MAAD-AF%20Modules/Compliance/Recon%20Existing%20eDiscovery%20Cases/#trigger","title":"Trigger","text":"<pre><code>MAAD Attack Arsenal -&gt; \"Compliance\" -&gt; 2\n</code></pre>"},{"location":"MAAD-AF%20Modules/Compliance/Recon%20Existing%20eDiscovery%20Cases/#mitre-attck-information","title":"MITRE ATT&amp;CK Information","text":"Tactic Technique Collection Automated Collection"},{"location":"MAAD-AF%20Modules/Compliance/Recon%20Existing%20eDiscovery%20Cases/#additional-details","title":"Additional Details","text":"<p>Revert module changes: No</p> <p>Microsoft services being accessed by this module:</p> <ul> <li>Compliance</li> </ul> <p>External PowerShell module used: </p> <ul> <li>ExchangePowerShell</li> </ul>"},{"location":"MAAD-AF%20Modules/Compliance/Recon%20Existing%20eDiscovery%20Searches/","title":"Recon Existing eDiscovery Searches","text":""},{"location":"MAAD-AF%20Modules/Compliance/Recon%20Existing%20eDiscovery%20Searches/#description","title":"Description","text":"<p><code>recon existing ediscovery searches</code> module executes reconnaissance to find searches in existing eDiscovery cases in the tenant. Existing searches can help quickly find critical data without having to launch new searches.</p>"},{"location":"MAAD-AF%20Modules/Compliance/Recon%20Existing%20eDiscovery%20Searches/#trigger","title":"Trigger","text":"<pre><code>MAAD Attack Arsenal -&gt; \"Compliance\" -&gt; 3\n</code></pre>"},{"location":"MAAD-AF%20Modules/Compliance/Recon%20Existing%20eDiscovery%20Searches/#mitre-attck-information","title":"MITRE ATT&amp;CK Information","text":"Tactic Technique Collection Automated Collection"},{"location":"MAAD-AF%20Modules/Compliance/Recon%20Existing%20eDiscovery%20Searches/#additional-details","title":"Additional Details","text":"<p>Revert module changes: No</p> <p>Microsoft services being accessed by this module:</p> <ul> <li>Compliance</li> </ul> <p>External PowerShell module used: </p> <ul> <li>ExchangePowerShell</li> </ul>"},{"location":"MAAD-AF%20Modules/Exchange/Disable%20Anti-Phishing%20Policy/","title":"Disable Anti-Phishing Policy","text":""},{"location":"MAAD-AF%20Modules/Exchange/Disable%20Anti-Phishing%20Policy/#description","title":"Description","text":"<p><code>disable anti-phishing policy</code> module modifies configuration to disable a specified exchange anti-phishing policy on a targeted mailbox.</p>"},{"location":"MAAD-AF%20Modules/Exchange/Disable%20Anti-Phishing%20Policy/#trigger","title":"Trigger","text":"<pre><code>MAAD Attack Arsenal -&gt; \"Exchange\" -&gt; 6\n</code></pre>"},{"location":"MAAD-AF%20Modules/Exchange/Disable%20Anti-Phishing%20Policy/#mitre-attck-information","title":"MITRE ATT&amp;CK Information","text":"Tactic Technique Defense Evasion Impair Defenses"},{"location":"MAAD-AF%20Modules/Exchange/Disable%20Anti-Phishing%20Policy/#additional-details","title":"Additional Details","text":"<p>Revert module changes: Yes</p> <p>Microsoft services accessed by module:</p> <ul> <li>Exchange Online</li> </ul> <p>External PowerShell module used: </p> <ul> <li>ExchangePowerShell</li> </ul>"},{"location":"MAAD-AF%20Modules/Exchange/Disable%20Mailbox%20Auditing/","title":"Disable Mailbox Auditing","text":""},{"location":"MAAD-AF%20Modules/Exchange/Disable%20Mailbox%20Auditing/#description","title":"Description","text":"<p><code>disable mailbox auditing</code> module deploys configuration to enable audit log bypass for a target account effectively disabling logging for actions taken by the account on any mailbox.</p>"},{"location":"MAAD-AF%20Modules/Exchange/Disable%20Mailbox%20Auditing/#trigger","title":"Trigger","text":"<pre><code>MAAD Attack Arsenal -&gt; \"Exchange\" -&gt; 5\n</code></pre>"},{"location":"MAAD-AF%20Modules/Exchange/Disable%20Mailbox%20Auditing/#mitre-attck-information","title":"MITRE ATT&amp;CK Information","text":"Tactic Technique Defense Evasion Impair Defenses"},{"location":"MAAD-AF%20Modules/Exchange/Disable%20Mailbox%20Auditing/#additional-details","title":"Additional Details","text":"<p>Revert module changes: Yes</p> <p>Microsoft services accessed by module:</p> <ul> <li>Exchange Online</li> </ul> <p>External PowerShell module used: </p> <ul> <li>ExchangePowerShell</li> </ul>"},{"location":"MAAD-AF%20Modules/Exchange/Exchange/","title":"Exchange","text":"<p>The <code>exchange</code> module provides techniques that target and take action against resources and configurations in Exchange Online. </p> <ul> <li>List Mailboxes in Tenant</li> <li>Gain Access to Another Mailbox</li> <li>Setup Email Forwarding</li> <li>Setup Email Deletion Rule</li> <li>Disable Mailbox Auditing</li> <li>Disable Anti-Phishing Policy</li> </ul>"},{"location":"MAAD-AF%20Modules/Exchange/Gain%20Access%20to%20Another%20Mailbox/","title":"Gain Access to Another Mailbox","text":""},{"location":"MAAD-AF%20Modules/Exchange/Gain%20Access%20to%20Another%20Mailbox/#description","title":"Description","text":"<p><code>gain access to another mailbox</code> module adds permissions to a target mailbox granting user access to that mailbox. </p>"},{"location":"MAAD-AF%20Modules/Exchange/Gain%20Access%20to%20Another%20Mailbox/#trigger","title":"Trigger","text":"<pre><code>MAAD Attack Arsenal -&gt; \"Exchange\" -&gt; 2\n</code></pre>"},{"location":"MAAD-AF%20Modules/Exchange/Gain%20Access%20to%20Another%20Mailbox/#mitre-attck-information","title":"MITRE ATT&amp;CK Information","text":"Tactic Technique Persistence Account Manipulation"},{"location":"MAAD-AF%20Modules/Exchange/Gain%20Access%20to%20Another%20Mailbox/#additional-details","title":"Additional Details","text":"<p>Revert module changes: Yes</p> <p>Microsoft services accessed by module:</p> <ul> <li>Exchange Online</li> </ul> <p>External PowerShell module used: </p> <ul> <li>ExchangePowerShell</li> </ul>"},{"location":"MAAD-AF%20Modules/Exchange/List%20Mailboxes%20in%20Tenant/","title":"List Mailboxes in Tenant","text":""},{"location":"MAAD-AF%20Modules/Exchange/List%20Mailboxes%20in%20Tenant/#description","title":"Description","text":"<p><code>list mailboxes in tenant</code> module executes reconnaissance to find exchange mailboxes in the connected tenant. </p>"},{"location":"MAAD-AF%20Modules/Exchange/List%20Mailboxes%20in%20Tenant/#trigger","title":"Trigger","text":"<pre><code>MAAD Attack Arsenal -&gt; \"Exchange\" -&gt; 1\n</code></pre>"},{"location":"MAAD-AF%20Modules/Exchange/List%20Mailboxes%20in%20Tenant/#mitre-attck-information","title":"MITRE ATT&amp;CK Information","text":"Tactic Technique Discovery Account Discovery: Email Account"},{"location":"MAAD-AF%20Modules/Exchange/List%20Mailboxes%20in%20Tenant/#additional-details","title":"Additional Details","text":"<p>Revert module changes: N/A (Recon Module)</p> <p>Microsoft services accessed by module:</p> <ul> <li>Exchange Online</li> </ul> <p>External PowerShell module used: </p> <ul> <li>ExchangePowerShell</li> </ul>"},{"location":"MAAD-AF%20Modules/Exchange/Setup%20Email%20Deletion%20Rule/","title":"Setup Email Deletion Rule","text":""},{"location":"MAAD-AF%20Modules/Exchange/Setup%20Email%20Deletion%20Rule/#description","title":"Description","text":"<p><code>setup email deletion rule</code> module deploys a new mailbox rule on a target mailbox that deletes emails matching a user specified criteria. This allows to hide emails that could indicate compromise such as security alerts, responses to Internal Spearphishing emails, etc. </p>"},{"location":"MAAD-AF%20Modules/Exchange/Setup%20Email%20Deletion%20Rule/#trigger","title":"Trigger","text":"<pre><code>MAAD Attack Arsenal -&gt; \"Exchange\" -&gt; 4\n</code></pre>"},{"location":"MAAD-AF%20Modules/Exchange/Setup%20Email%20Deletion%20Rule/#mitre-attck-information","title":"MITRE ATT&amp;CK Information","text":"Tactic Technique Defense Evasion Hide Artifacts: Email Hiding Rules"},{"location":"MAAD-AF%20Modules/Exchange/Setup%20Email%20Deletion%20Rule/#additional-details","title":"Additional Details","text":"<p>Revert module changes: Yes</p> <p>Microsoft services accessed by module:</p> <ul> <li>Exchange Online</li> </ul> <p>External PowerShell module used: </p> <ul> <li>ExchangePowerShell</li> </ul>"},{"location":"MAAD-AF%20Modules/Exchange/Setup%20Email%20Forwarding/","title":"Setup Mail Forwarding","text":""},{"location":"MAAD-AF%20Modules/Exchange/Setup%20Email%20Forwarding/#description","title":"Description","text":"<p><code>setup mail forwarding</code> module deploys a new mailbox forwarding rule on the target mailbox. This module forwards emails from the target mailbox to an external mailbox. </p>"},{"location":"MAAD-AF%20Modules/Exchange/Setup%20Email%20Forwarding/#trigger","title":"Trigger","text":"<pre><code>MAAD Attack Arsenal -&gt; \"Exchange\" -&gt; 3\n</code></pre>"},{"location":"MAAD-AF%20Modules/Exchange/Setup%20Email%20Forwarding/#mitre-attck-information","title":"MITRE ATT&amp;CK Information","text":"Tactic Technique Collection Email Collection"},{"location":"MAAD-AF%20Modules/Exchange/Setup%20Email%20Forwarding/#additional-details","title":"Additional Details","text":"<p>Revert module changes: Yes</p> <p>Microsoft services accessed by module:</p> <ul> <li>Exchange Online</li> </ul> <p>External PowerShell module used: </p> <ul> <li>ExchangePowerShell</li> </ul>"},{"location":"MAAD-AF%20Modules/Group/Add%20user%20to%20Group/","title":"Add User to Group","text":""},{"location":"MAAD-AF%20Modules/Group/Add%20user%20to%20Group/#description","title":"Description","text":"<p><code>add user to group</code> module attempts adding a target account to a sepcified group allowing account to assume the group roles. </p>"},{"location":"MAAD-AF%20Modules/Group/Add%20user%20to%20Group/#trigger","title":"Trigger","text":"<pre><code>MAAD Attack Arsenal -&gt; \"Group\" -&gt; 3\n</code></pre>"},{"location":"MAAD-AF%20Modules/Group/Add%20user%20to%20Group/#mitre-attck-information","title":"MITRE ATT&amp;CK Information","text":"Tactic Technique Persistence Account Manipulation: Additional Cloud Roles"},{"location":"MAAD-AF%20Modules/Group/Add%20user%20to%20Group/#additional-details","title":"Additional Details","text":"<p>Microsoft services being accessed by this module:</p> <ul> <li>Entra ID (Azure AD)</li> </ul> <p>External PowerShell module used: </p> <ul> <li>AzureAd</li> </ul>"},{"location":"MAAD-AF%20Modules/Group/Assign%20Role%20to%20Group/","title":"Assign Role to Group","text":""},{"location":"MAAD-AF%20Modules/Group/Assign%20Role%20to%20Group/#description","title":"Description","text":"<p><code>assign role to group</code> module attempts to assign a role to a specified target group.</p>"},{"location":"MAAD-AF%20Modules/Group/Assign%20Role%20to%20Group/#trigger","title":"Trigger","text":"<pre><code>MAAD Attack Arsenal -&gt; \"Group\" -&gt; 4\n</code></pre>"},{"location":"MAAD-AF%20Modules/Group/Assign%20Role%20to%20Group/#mitre-attck-information","title":"MITRE ATT&amp;CK Information","text":"Tactic Technique Persistence Account Manipulation: Additional Cloud Roles"},{"location":"MAAD-AF%20Modules/Group/Assign%20Role%20to%20Group/#additional-details","title":"Additional Details","text":"<p>Microsoft services being accessed by this module:</p> <ul> <li>Entra ID (Azure AD)</li> </ul> <p>External PowerShell module used: </p> <ul> <li>AzureAd</li> </ul>"},{"location":"MAAD-AF%20Modules/Group/Create%20Group/","title":"Create Group","text":""},{"location":"MAAD-AF%20Modules/Group/Create%20Group/#description","title":"Description","text":"<p><code>create group</code> module creates a new group in Entra ID.</p>"},{"location":"MAAD-AF%20Modules/Group/Create%20Group/#trigger","title":"Trigger","text":"<pre><code>MAAD Attack Arsenal -&gt; \"Group\" -&gt; 2\n</code></pre>"},{"location":"MAAD-AF%20Modules/Group/Create%20Group/#mitre-attck-information","title":"MITRE ATT&amp;CK Information","text":"Tactic Technique N/A N/A"},{"location":"MAAD-AF%20Modules/Group/Create%20Group/#additional-details","title":"Additional Details","text":"<p>Microsoft services being accessed by this module:</p> <ul> <li>Entra ID (Azure AD)</li> </ul> <p>External PowerShell module used: </p> <ul> <li>AzureAd</li> </ul>"},{"location":"MAAD-AF%20Modules/Group/Group/","title":"Group","text":"<p>The <code>group</code> module provides techniques that target or take action against a user group in Entra ID. </p> <ul> <li>List Groups in Tenant</li> <li>Create Group</li> <li>Add user to Group</li> <li>Assign Role to Group</li> </ul>"},{"location":"MAAD-AF%20Modules/Group/List%20Groups%20in%20Tenant/","title":"List Groups in Tenant","text":""},{"location":"MAAD-AF%20Modules/Group/List%20Groups%20in%20Tenant/#description","title":"Description","text":"<p><code>list groups in tenant</code> module performs reconnaissance in the connected Entra ID tenant to lists all groups in the tenant. If the result is too large to display, the module dumps the groups found into <code>\\Outputs</code> directory.</p>"},{"location":"MAAD-AF%20Modules/Group/List%20Groups%20in%20Tenant/#trigger","title":"Trigger","text":"<pre><code>MAAD Attack Arsenal -&gt; \"Group\" -&gt; 1\n</code></pre>"},{"location":"MAAD-AF%20Modules/Group/List%20Groups%20in%20Tenant/#mitre-attck-information","title":"MITRE ATT&amp;CK Information","text":"Tactic Technique Discovery Permission Groups Discovery: Cloud Groups"},{"location":"MAAD-AF%20Modules/Group/List%20Groups%20in%20Tenant/#additional-details","title":"Additional Details","text":"<p>Microsoft services being accessed by this module:</p> <ul> <li>Entra ID (Azure AD)</li> </ul> <p>External PowerShell module used: </p> <ul> <li>AzureAd</li> </ul>"},{"location":"MAAD-AF%20Modules/Pre-Attack/Brute-Force%20Credentials/","title":"Brute-Force Credentials","text":""},{"location":"MAAD-AF%20Modules/Pre-Attack/Brute-Force%20Credentials/#description","title":"Description","text":"<p><code>brute-force credentials</code> module executes a password brute-force attack on a target identity in Entra ID. Brute-force attempts to gain access to an account when the password for the account is unknown. </p> <p>This module requires a password list in txt file format as input for bruteforce. Placed the password file in <code>\\MAAD-AF</code> directory.</p> <p>If the brute-force is successful, this module stores the cracked credentials in MAAD Credential Store for use in future.</p>"},{"location":"MAAD-AF%20Modules/Pre-Attack/Brute-Force%20Credentials/#trigger","title":"Trigger","text":"<pre><code>MAAD Attack Arsenal -&gt; \"Pre-Attack\" -&gt; 2\n</code></pre>"},{"location":"MAAD-AF%20Modules/Pre-Attack/Brute-Force%20Credentials/#mitre-attck-information","title":"MITRE ATT&amp;CK Information","text":"Tactic Technique Credential Access Brute Force"},{"location":"MAAD-AF%20Modules/Pre-Attack/Brute-Force%20Credentials/#additional-details","title":"Additional Details","text":"<ul> <li>Brute-force is attempted against the reporting web service endpoint: https://reports.office365.com/ecp/reportingwebservice/reporting.svc</li> </ul>"},{"location":"MAAD-AF%20Modules/Pre-Attack/Pre-Attack/","title":"Pre-Attack","text":"<p>The <code>pre-attack</code> module provides techniques that can be used to gather intel on an organization before compromise or to gain initial access. </p> <ul> <li>Recon Organization/Identiy</li> <li>Brute-Force Credentials</li> </ul>"},{"location":"MAAD-AF%20Modules/Pre-Attack/Recon%20Organization%20or%20Identity/","title":"Recon Organization/Identity","text":""},{"location":"MAAD-AF%20Modules/Pre-Attack/Recon%20Organization%20or%20Identity/#description","title":"Description","text":"<p><code>recon organization/identity</code> module executes uses a username/email address and executes reconnaissance to return various information such as tenant info, account existence in target tenant, DNS info, etc. </p>"},{"location":"MAAD-AF%20Modules/Pre-Attack/Recon%20Organization%20or%20Identity/#trigger","title":"Trigger","text":"<pre><code>MAAD Attack Arsenal -&gt; \"Pre-Attack\" -&gt; 1\n</code></pre>"},{"location":"MAAD-AF%20Modules/Pre-Attack/Recon%20Organization%20or%20Identity/#mitre-attck-information","title":"MITRE ATT&amp;CK Information","text":"Tactic Technique Discovery Account Discovery"},{"location":"MAAD-AF%20Modules/Pre-Attack/Recon%20Organization%20or%20Identity/#additional-details","title":"Additional Details","text":"<p>External PowerShell module used: </p> <ul> <li>AADInternals</li> </ul>"},{"location":"MAAD-AF%20Modules/Recon/Recon/","title":"Recon","text":"<p>The <code>recon</code> module provides techniques to execute reconnaissance against various services to gather information about the tenant and its resources. </p> <ul> <li>AAD : Find All Accounts</li> <li>AAD : Find All Groups</li> <li>AAD : Find All Service Principals</li> <li>AAD : Find All Auth Policy</li> <li>AAD : Recon Named Locations</li> <li>AAD : Recon Conditional Access Policy</li> <li>AAD : Recon Registered Devices for Account</li> <li>AAD : Recon All Accessible Tenants</li> <li>AAD : Recon Account Group Roles</li> <li>Teams : Recon All Teams</li> <li>SP : Recon All Sharepoint Sites</li> <li>Exchange : Find All Mailboxes</li> </ul>"},{"location":"MAAD-AF%20Modules/SharePoint/Exfiltrate%20Data%20from%20Sharepoint/","title":"Exfiltrate Data from SharePoint","text":""},{"location":"MAAD-AF%20Modules/SharePoint/Exfiltrate%20Data%20from%20Sharepoint/#description","title":"Description","text":"<p><code>exfiltrate data from sharepoint</code> module exfiltrates all files or files matching a user defined criteria to the users local host.</p>"},{"location":"MAAD-AF%20Modules/SharePoint/Exfiltrate%20Data%20from%20Sharepoint/#trigger","title":"Trigger","text":"<pre><code>MAAD Attack Arsenal -&gt; \"SharePoint\" -&gt; 4\n</code></pre>"},{"location":"MAAD-AF%20Modules/SharePoint/Exfiltrate%20Data%20from%20Sharepoint/#mitre-attck-information","title":"MITRE ATT&amp;CK Information","text":"Tactic Technique Collection Data from Information Repositories: Sharepoint"},{"location":"MAAD-AF%20Modules/SharePoint/Exfiltrate%20Data%20from%20Sharepoint/#additional-details","title":"Additional Details","text":"<p>Microsoft services being accessed by this module:</p> <ul> <li>SharePoint</li> </ul> <p>External PowerShell module used: </p> <ul> <li>PnP.PowerShell</li> </ul>"},{"location":"MAAD-AF%20Modules/SharePoint/Gain%20Access%20to%20Sharepoint%20Site/","title":"Gain Access to SharePoint Site","text":""},{"location":"MAAD-AF%20Modules/SharePoint/Gain%20Access%20to%20Sharepoint%20Site/#description","title":"Description","text":"<p><code>gain access to sharepoint site</code> module attempts to leverage the connected users privilege to grant access to a target SharePoint site.</p>"},{"location":"MAAD-AF%20Modules/SharePoint/Gain%20Access%20to%20Sharepoint%20Site/#trigger","title":"Trigger","text":"<pre><code>MAAD Attack Arsenal -&gt; \"SharePoint\" -&gt; 2\n</code></pre>"},{"location":"MAAD-AF%20Modules/SharePoint/Gain%20Access%20to%20Sharepoint%20Site/#mitre-attck-information","title":"MITRE ATT&amp;CK Information","text":"Tactic Technique Collection Data from Information Repositories: Sharepoint"},{"location":"MAAD-AF%20Modules/SharePoint/Gain%20Access%20to%20Sharepoint%20Site/#additional-details","title":"Additional Details","text":"<p>Microsoft services being accessed by this module:</p> <ul> <li>SharePoint</li> </ul> <p>External PowerShell module used: </p> <ul> <li>PnP.PowerShell</li> </ul>"},{"location":"MAAD-AF%20Modules/SharePoint/List%20Sharepoint%20Sites/","title":"List SharePoint Sites","text":""},{"location":"MAAD-AF%20Modules/SharePoint/List%20Sharepoint%20Sites/#description","title":"Description","text":"<p><code>list sharepoint sites</code> module executes reconnaissance to find all SharePoint sites in the tenant.</p>"},{"location":"MAAD-AF%20Modules/SharePoint/List%20Sharepoint%20Sites/#trigger","title":"Trigger","text":"<pre><code>MAAD Attack Arsenal -&gt; \"SharePoint\" -&gt; 1\n</code></pre>"},{"location":"MAAD-AF%20Modules/SharePoint/List%20Sharepoint%20Sites/#mitre-attck-information","title":"MITRE ATT&amp;CK Information","text":"Tactic Technique Collection Data from Information Repositories: Sharepoint"},{"location":"MAAD-AF%20Modules/SharePoint/List%20Sharepoint%20Sites/#additional-details","title":"Additional Details","text":"<p>Microsoft services being accessed by this module:</p> <ul> <li>SharePoint</li> </ul> <p>External PowerShell module used: </p> <ul> <li>PnP.PowerShell</li> </ul>"},{"location":"MAAD-AF%20Modules/SharePoint/Search%20Files%20in%20Sharepoint/","title":"Search Files in SharePoint Site","text":""},{"location":"MAAD-AF%20Modules/SharePoint/Search%20Files%20in%20Sharepoint/#description","title":"Description","text":"<p><code>search files in sharepoint site</code> module executes reconnaissance on a target SharePoint site to find files matching a user defined search parameter.</p>"},{"location":"MAAD-AF%20Modules/SharePoint/Search%20Files%20in%20Sharepoint/#trigger","title":"Trigger","text":"<pre><code>MAAD Attack Arsenal -&gt; \"SharePoint\" -&gt; 3\n</code></pre>"},{"location":"MAAD-AF%20Modules/SharePoint/Search%20Files%20in%20Sharepoint/#mitre-attck-information","title":"MITRE ATT&amp;CK Information","text":"Tactic Technique Collection Data from Information Repositories: Sharepoint"},{"location":"MAAD-AF%20Modules/SharePoint/Search%20Files%20in%20Sharepoint/#additional-details","title":"Additional Details","text":"<p>Microsoft services being accessed by this module:</p> <ul> <li>SharePoint</li> </ul> <p>External PowerShell module used: </p> <ul> <li>PnP.PowerShell</li> </ul>"},{"location":"MAAD-AF%20Modules/SharePoint/SharePoint/","title":"SharePoint","text":"<p>The <code>sharepoint</code> module provides techniques that target or take action against SharePoint resources. </p> <ul> <li>List Sharepoint Sites</li> <li>Gain Access to Sharepoint Site</li> <li>Search Files in Sharepoint</li> <li>Exfiltrate Data from Sharepoint</li> <li>Upload File to Sharepoint Site</li> </ul>"},{"location":"MAAD-AF%20Modules/SharePoint/Upload%20File%20to%20Sharepoint%20Site/","title":"Upload File to SharePoint Site","text":""},{"location":"MAAD-AF%20Modules/SharePoint/Upload%20File%20to%20Sharepoint%20Site/#description","title":"Description","text":"<p><code>upload file to sharepoint site</code> module allows user to upload a (malicious) file to a target SharePoint site. This allows to deliver payload to other hosts who may download from the shared repository.</p>"},{"location":"MAAD-AF%20Modules/SharePoint/Upload%20File%20to%20Sharepoint%20Site/#trigger","title":"Trigger","text":"<pre><code>MAAD Attack Arsenal -&gt; \"SharePoint\" -&gt; 3\n</code></pre>"},{"location":"MAAD-AF%20Modules/SharePoint/Upload%20File%20to%20Sharepoint%20Site/#mitre-attck-information","title":"MITRE ATT&amp;CK Information","text":"Tactic Technique Lateral Movement Taint Shared Content"},{"location":"MAAD-AF%20Modules/SharePoint/Upload%20File%20to%20Sharepoint%20Site/#additional-details","title":"Additional Details","text":"<p>Microsoft services being accessed by this module:</p> <ul> <li>SharePoint</li> </ul> <p>External PowerShell module used: </p> <ul> <li>PnP.PowerShell</li> </ul>"},{"location":"MAAD-AF%20Modules/Teams/Invite%20External%20User%20to%20Teams/","title":"Invite External User to Teams","text":""},{"location":"MAAD-AF%20Modules/Teams/Invite%20External%20User%20to%20Teams/#description","title":"Description","text":"<p><code>invite external user to teams</code> module invites an external entity to Entra ID and attempts to add it to a teams group. This allows to maintain access to information in the teams group using the external entity.</p>"},{"location":"MAAD-AF%20Modules/Teams/Invite%20External%20User%20to%20Teams/#trigger","title":"Trigger","text":"<pre><code>MAAD Attack Arsenal -&gt; \"Teams\" -&gt; 3\n</code></pre>"},{"location":"MAAD-AF%20Modules/Teams/Invite%20External%20User%20to%20Teams/#mitre-attck-information","title":"MITRE ATT&amp;CK Information","text":"Tactic Technique Collection Data from Information Repositories"},{"location":"MAAD-AF%20Modules/Teams/Invite%20External%20User%20to%20Teams/#additional-details","title":"Additional Details","text":"<p>Revert module changes: Yes</p> <p>Microsoft services accessed by module:</p> <ul> <li>Teams</li> </ul> <p>External PowerShell module used: </p> <ul> <li>Azure AD</li> <li>MicrosoftTeamsPowerShell</li> </ul>"},{"location":"MAAD-AF%20Modules/Teams/List%20Teams%20in%20Tenant/","title":"List Teams in Tenant","text":""},{"location":"MAAD-AF%20Modules/Teams/List%20Teams%20in%20Tenant/#description","title":"Description","text":"<p><code>list teams in tenant</code> module executes reconnaissance to find all teams in the connected Entra ID tenant. </p>"},{"location":"MAAD-AF%20Modules/Teams/List%20Teams%20in%20Tenant/#trigger","title":"Trigger","text":"<pre><code>MAAD Attack Arsenal -&gt; \"Teams\" -&gt; 1\n</code></pre>"},{"location":"MAAD-AF%20Modules/Teams/List%20Teams%20in%20Tenant/#mitre-attck-information","title":"MITRE ATT&amp;CK Information","text":"Tactic Technique Discovery Permission Groups Discovery: Cloud Groups"},{"location":"MAAD-AF%20Modules/Teams/List%20Teams%20in%20Tenant/#additional-details","title":"Additional Details","text":"<p>Revert module changes: N/A</p> <p>Microsoft services accessed by module:</p> <ul> <li>Teams</li> </ul> <p>External PowerShell module used: </p> <ul> <li>MicrosoftTeamsPowerShell</li> </ul>"},{"location":"MAAD-AF%20Modules/Teams/Search%20Creds%20in%20Teams/","title":"Search Creds in Teams","text":""},{"location":"MAAD-AF%20Modules/Teams/Search%20Creds%20in%20Teams/#description","title":"Description","text":"<p><code>search credentials in teams</code> module searches for specified keywords in a target team. This can be used to find credentials or other critical data share in chat messages. </p>"},{"location":"MAAD-AF%20Modules/Teams/Search%20Creds%20in%20Teams/#trigger","title":"Trigger","text":"<pre><code>MAAD Attack Arsenal -&gt; \"Teams\" -&gt; 2\n</code></pre>"},{"location":"MAAD-AF%20Modules/Teams/Search%20Creds%20in%20Teams/#mitre-attck-information","title":"MITRE ATT&amp;CK Information","text":"Tactic Technique Credential Access Unsecured Credentials: Chat Messages"},{"location":"MAAD-AF%20Modules/Teams/Search%20Creds%20in%20Teams/#additional-details","title":"Additional Details","text":"<p>Revert module changes: N/A</p> <p>Microsoft services accessed by module:</p> <ul> <li>Teams</li> </ul> <p>External PowerShell module used: </p> <ul> <li>MicrosoftTeamsPowerShell</li> </ul>"},{"location":"MAAD-AF%20Modules/Teams/Teams/","title":"Teams","text":"<p>The <code>teams</code> module provides techniques that target or take action against teams. </p> <ul> <li>List Teams in Tenant</li> <li>Search Creds in Teams</li> <li>Invite External User to Teams</li> </ul>"},{"location":"Usage/","title":"Setup &amp; Run","text":"<ol> <li> <p>Open PowerShell as Administrator</p> </li> <li> <p>Download or clone latest version of MAAD-AF to your local host</p> <p>git clone https://github.com/vectra-ai-research/MAAD-AF.git</p> </li> <li> <p>Navigate to the downloaded MAAD-AF directory</p> <p>cd /MAAD-AF</p> </li> <li> <p>Launch MAAD-AF</p> <p>./MAAD_Attack.ps1</p> </li> </ol> <p>That's it! :)</p> <p></p>"},{"location":"Usage/#interacting-with-maad-af","title":"Interacting with MAAD-AF","text":"<p>Interacting with MAAD-AF follows a simple workflow for all techniques:</p> <pre><code>MAAD Attack Arsenal -&gt; Primary Module name -&gt; Sub-Module # choice -&gt; Follow prompts to execute\n</code></pre> <ol> <li>From MAAD Attack Arsenal, select a Primary Module by typing its name, eg: \"Access\"</li> <li>Enter the sub-module number from the list to select the technique/sub-module, eg: 2</li> <li>Follow on-screen prompts to execute the technique</li> </ol> <p></p>"},{"location":"Usage/#executing-your-first-maad-af-module","title":"Executing Your First MAAD-AF Module","text":"<ol> <li>Launch MAAD-AF by typing below command in PowerShell from MAAD-AF directory <p>./MAAD_Attack.ps1</p> </li> <li>Hit <code>Enter</code> to agree to the consent and continue</li> <li>Wait for dependency check to complete. If MAAD-AF prompts you of any missing modules, enter <code>Yes</code> to 'Automatically install missing modules? (Yes / No)'</li> <li>Type <code>No</code> and press <code>Enter</code> for prompt 'Do you want to keep your traffic anonymous?' (You can learn more about this option here and choose <code>Yes</code> in subsequent runs)</li> <li>Welcome to MAAD Attack Arsenal which displays all the primary MAAD-AF attack modules</li> <li>Type <code>access</code> (case insensitive) and press <code>Enter</code> to select the \"Access\" module</li> <li>Type <code>1</code> and press <code>Enter</code> to select sub-module \"1\" from the list.</li> <li>Enter your testing credentials by following the on-screen prompts</li> <li>MAAD-AF will attempt to access various Microsoft cloud services based on the access &amp; privilege of the credential supplied. </li> </ol> <p>Congratulations! You successfully executed your first MAAD-AF module attempting initial access to Microsoft cloud services.</p>"},{"location":"Usage/#special-keywords","title":"Special Keywords","text":"<p>MAAD-AF special commands allows users to execute certain frequently used functions without navigating through options heirarchy. As you start to perform more frequent testing these special commands will come handy to make your use of MAAD-AF more speedy and enjoyable. These commands can also be referenced directly within MAAD-AF by typing <code>HELP</code>in the MAAD Attack Arsenal menu. Alternatively, you can continue to use MAAD-AF without ever using any of these special keywords. </p> MAAD-AF Special Keywords Description SHOW ALL Expand all options in MAAD Attack Arsenal for a full list of options. ADD CREDS Add new credentials to the MAAD-AF credentials store for quickly establishing access later. SHOW CREDS Show all credentials collected in MAAD-AF credentials store. ESTABLISH ACCESS Initiate access attempt to Micrsoft services using stored or new credentials. SWITCH ACCESS Use another credential from Credential Store to establish access in modules ACCESS INFO Display details about my current access session KILL ACCESS Terminate all active connections EXECUTE RECON Gather all information from the environment using the current access and MAAD-AF reconnaissance modules EXIT Exit MAAD-AF without closing active access connections. FULL EXIT Exit MAAD-AF and close all active access connections."},{"location":"Usage/Requirements/","title":"Requirements","text":"<p>MAAD-AF requriements are minimal to enable quick setup: </p> <ol> <li>Windows host with PowerShell 5 and local host permissions to run un-signed scripts (any Windows host, can be a Virtual Machine too)</li> <li>Internet connection</li> <li>Entra ID (Azure AD) credentials for security testing (used to execute attacks)</li> </ol> <p>Note: MAAD-AF does require certain standard powershell modules that it gathers automatically at launch.</p>"},{"location":"Usage/Testing%20Paths/","title":"Sample Tests","text":"<p>There is no strict way to use MAAD-AF (be creative). The modular structure allows users to execute attack modules in any sequence. Security practitioners can leverage the documented testing paths as example playbooks or reference to build their own.</p>"},{"location":"Usage/Testing%20Paths/#test-path-1","title":"Test Path 1","text":"<p>An attacker compromises an identity through a phishing campaign to gain access to various Microsoft cloud services in the environment to steal high from M365 applications.</p> <p>Standard employee accounts can be exploited to collect and exfiltrate critical data or abuse an identity\u2019s reputation for greater organizational access. An attacker with access to an identity can easily access and exfiltrate data from cloud-accessible repositories, such as emails in users\u2019 mailboxes, files in accessible SharePoint sites, teams messages, etc. During their attack, they may set up mail forwarding rules for continuous exfiltration or mailbox rules to hide signs of compromise. Once an attacker controls an account, they have access to any associated SaaS applications, leading to greater spreading through the organization.</p> <pre><code>Test Credential Privileges Required : Any identity with a exchange mailbox\n</code></pre> MAAD-AF Technique Name MAAD-AF Modules MITRE Techniques Access via compromised credentials Access.3 Initial Access : Valid Accounts: Cloud Accounts Download from Sharepoint Sharepoint.4 Collection : Data from Information Repositories : Sharepoint Setup email deletion rule Exchange.4 Defense Evasion : Hide Artifacts Setup email forwarding Exchange.3 Collection : Email Collection"},{"location":"Usage/Testing%20Paths/#test-path-2","title":"Test Path 2","text":"<p>Attackers have compromised a somewhat privileged identity in your environment through a credential breach. The attacker exploits the compromised identity's access &amp; privileges to gain access to various Microsoft cloud services in the environment to perform reconnaissance, establish persistence, and perform privilege escalation.</p> <p>Attackers exploit the access and privileges of the compromised identity to find valuable information within the environment and explore ways of abusing it further. In this case the attacker is exploiting the privileges of a user administrator in the environment to get all employees information which can be used in a further exploitation or in a future attack. The attacker also leverages the privilege of creating new identities in the environment to establish a backdoor that will allow for persistent access in future even the initially compromised identity were to get locked down. The attacker also attempts to assign privileges to the new backdoor account to allow execution of additional actions in the environment. Finally the attacker also attempts to reset password of another privileged identity which will allow the attacker to laterally move and perform actions with this new identities access &amp; privileges.</p> <pre><code>Test Credential Privileges Required : User Administrator\n* To execute all techniques with one credential\n</code></pre> MAAD-AF Technique Name MAAD-AF Modules MITRE Techniques All actions from PATH 1 # - Access via compromised credentials Access.3 Initial Access :\u00a0Valid Accounts: Cloud Accounts Dump user information Recon.1 or Account.1 Account Discovery: Cloud Account Deploy backdoor account Account.2 Create Account: Cloud Account Assign role Account.3 Persistence\u00a0: Manipulation: Additional Cloud Roles Reset password for another privileged identity Account.5 Valid Accounts: Cloud Accounts"},{"location":"Usage/Testing%20Paths/#test-path-3","title":"Test Path 3","text":"<p>Attackers have gained access to a privileged identity in your environment through credentials bought on the dark web. Attackers enumerate through various Microsoft cloud services to gain access to them using the compromised identity's access &amp; privilege.</p> <p>With this level of access &amp; privilege, attackers want to unlock access to as much service &amp; data as possible in the environment and then exfiltrate it. Attackers begin by modifying trusted IP configuration to bypass any resource protect by a IP based conditional access policy. To maintain persistent access to critical information, attackers add an external attacker-controlled account to teams. To avoid leaving track of their actions, attackers proceed by attempting to disable Mailbox auditing. Attrackers progress by disabling MFA on a user account and then gaining access to that executive users mailbox followed by setting up mail forwarding from the mailbox which gives them access to a lot of sensitive data. Finally attackers attempt to leverage eDiscovery, a powerful search tool in Microsoft cloud environments. They create new searches to find sensitive data across different data repositories followed by escalating privileges to eDiscovery manager to exfiltrate that data out of the environment.</p> <pre><code>Test Credential Privileges Required : `Global Administrator`\n* To execute all techniques with one credential\n</code></pre> MAAD-AF Technique Name MAAd-AF Modules MITRE Technique All actions from PATH 1 &amp; 2 # - Access via compromised credentials Access.3 Initial Access :\u00a0Valid Accounts: Cloud Accounts Modify Trusted IP configuration AzureAD.1 Defense Evasion : Impair Defenses Invite External User to Teams Teams.3 Collection : Data from Information Repositories Disable Mailbox Auditing Exchange.5 Defense Evasion : Impair Defenses Disable MFA Account.7 Defense Evasion : Modify Authentication Process : Multi-Factor Authentication Gain Access to Another Users Mailbox Exchange.2 Persistence :\u00a0Account Manipulation Setup Email Forwarding Exchange.3 Collection :\u00a0Email Collection eDiscovery search Compliance.1 Collection :\u00a0Automated Collection eDiscovery Privilege Esc. (Optional) Compliance.7 Account Manipulation: Additional Cloud Roles eDiscovery Exfil Compliance.6 Collection : Automated Collection"},{"location":"Usage/Troubleshoot/","title":"Troubleshoot","text":"<p>This page documents any minor issues faced while using MAAD-AF or running the security testing, so anyone looking for a quick fix can easily find it if not elsewhere on the internet. </p> <p>To report any major issues encountered or bugs identified please open an issue on MAAD-AF Github.</p>"},{"location":"Usage/Troubleshoot/#1-powershell-blocking-execution-for-modules-in-maad-af-upon-launch","title":"1. PowerShell blocking execution for modules in MAAD-AF upon launch.","text":""},{"location":"Usage/Troubleshoot/#solution","title":"Solution","text":"<p>Step 1: Exit MAAD-AF by pressing <code>ctrl+c</code>. </p> <p>Step 2: From MAAD-AF parent directory <code>/MAAD-AF</code> in PowerShell run the following two commands: </p> <pre><code>Unblock-File -Path ./MAAD_Attack.ps1\n\nUnblock-File -Path ./Library/*\n</code></pre>"}]}